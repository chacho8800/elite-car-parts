{% extends "base.html" %} {% load static %}

{% block head %}
<title>{{ part.name }}</title>
<link rel="stylesheet" href="{% static 'css/parts/part-detail.css' %}">
{% endblock %}

{% block content %}
<div class="part-detail card">
    <h1 class="part-title">{{ part.name }}</h1>

    <div class="part-image">
        <img src="{{ part.img.url }}" alt="{{ part.name }}" loading="lazy">
    </div>

    <div class="part-info">
        <p><strong>Brand:</strong> {{ part.brand }}</p>
        <p><strong>Price:</strong> ${{ part.price }}</p>
        <p><strong>Part Number:</strong> {{ part.part_number }}</p>
    </div>
    <hr >
    <h2>Compatible Car</h2>
    <div class='car-info'>
        <p><strong>Make:</strong> {{ part.car.make }}</p>
        <p><strong>Model:</strong> {{ part.car.model}}</p>
        <p><strong>Year:</strong> {{ part.car.year}}</p>
    </div>

    <hr>

    <h1>Add Review</h1>

    <form method="POST" action="{% url 'add-review' part.id %}">
    {% csrf_token %}
    <label for="rating">Rating (1–5):</label>
    <input type="number" id="rating" name="rating" min="1" max="5" required>

    <label for="comment">Your Comment:</label>
    <textarea id="comment" name="comment" rows="4" placeholder="Write your review..." required></textarea>

    <button type="submit" class="btn btn-primary">Submit</button>
    </form>
    <h2>Customer Reviews</h2>

    {% if part.review_set.all %}
        {% for review in part.review_set.all %}
    <div class="review-card">
      <p><strong>{{ review.user.username }}</strong> — ⭐ {{ review.rating }}/5</p>
      <p>{{ review.comment }}</p>
      <small>{{ review.createdAt|date:"M d, Y" }}</small>
    </div>
    {% endfor %}
    {% else %}
    <p>No reviews yet. Be the first to add one!</p>
    {% endif %}

    <div class="part-actions">
        <a href="{% url 'add-to-cart' part.id%}" class="btn btn-primary">Add to Cart</a>
        <a href="{% url 'part-index' %}" class="btn btn-secondary">Back to Parts</a>
    </div>
</div>
{% endblock %}